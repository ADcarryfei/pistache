#!/usr/bin/make -f

# SPDX-FileCopyrightText: 2019 Kip Warner
#
# SPDX-License-Identifier: Apache-2.0

# Output every command that modifies files on the build system...
# export DH_VERBOSE = 1

# Set flags for how the package will be compiled and built. Note separated with
#  white space and not comma, as per DPM ยง 4.9.1...

# Set various group related security hardening build flags for format,
#  fortify, stackprotector, relro, bindnow, and pie...
export DH_BUILD_MAINT_OPTIONS = hardening=+all

export LC_ALL = C.UTF-8

# Main packaging script based on debhelper 7 syntax. The % is an implicit
#  pattern rule that acts as a universal target...
%:
	dh $@ --buildsystem=meson

# Configure source...
override_dh_auto_configure:
	dh_auto_configure -- \
		--default-library=both \
		-DPISTACHE_BUILD_EXAMPLES=true \
		-DPISTACHE_BUILD_TESTS=true \
		-DPISTACHE_ENABLE_NETWORK_TESTS=false \
		-DPISTACHE_BUILD_DOCS=false \
		-DPISTACHE_USE_SSL=true

#override_dh_auto_test: https://github.com/pistacheio/pistache/blob/f3080e9e4e7ce5d0cb866b5d6320d51205c33ff0/debian/rules#L53-L63
